---
title: "Lesson 14 and 15: Python for geo-scripting"
author: "Jan Verbesselt, Jorge Mendes de Jesus, Aldo Bergsma, Eliakim Hamunyela"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    theme: united
    toc_depth: 4
    number_sections: true
---

# Introduction

## Getting started with Python within OS-GEO live linux

- Launch osgeo live from vmware viewer, login.
- Open the terminal and type the following to check the installed GDAL version:

```{r, eval = FALSE, engine='bash'}
## from R: system("gdal-config --version")
## From the terminal:
gdal-config --version
```

- type the following to start python and find out what the python version is:
To start Python:
```{r, eval=FALSE}
python
```

An example script to find out what the installed Python version is ([more info in question asked on stackoverflow](https://stackoverflow.com/questions/1093322/how-do-i-check-what-version-of-python-is-running-my-script))

```{r, engine='python'}
import sys
print sys.version #parentheses necessary in python 3. 
```

To exit python:
```{r, engine='bash', eval=FALSE}
exit()
```

- Open the python script within a Python editor

## A short Python refresher

*Question*: What is the difference between 10 and 10.0 when dealing with datatypes in Python???

```{r, eval=FALSE, message=FALSE, echo=FALSE}
# 10 -> Integer -> Natural + negative numbers
## Int
# 10.0 -> Floating point -> Real number() -> "digits before and after the decimal point"
## Float
```

```{r, engine='python'}
print(int(10.6))
```

Variable is a storage location or symbolic name to a value e.g.

```{r, engine='python'}
building = 'Gaia'
buildingNumber = 101
'Gaia'
```

There is no need to say or define the datatype, `python` has a loose type variable declaration. *Walk like a duck and swims like a duck and quacks like a duck I call it a duck*



## Handling Vector data with Python

Below we will explain step by step what is done is the python script so that you
can work on the script from home.

- define two points in Google Earth
- set the projection and reproject to the Dutch projection
- measure the distance between these points
- draw a line between the points
- create a buffer around the points
- export the point to a kml or shape file to be imported in Google Earth or QGIS

### Points

```{r, engine='python'}
from osgeo import ogr
# Create a point geometry
wkt = "POINT (173914.00 441864.00)"
pt = ogr.CreateGeometryFromWkt(wkt)
print(pt)
```

### Define a spatial reference

See http://spatialreference.org/ref/epsg/wgs-84/ 

```{r, engine='python'}
from osgeo import osr
##  spatial reference
spatialRef = osr.SpatialReference()
spatialRef.ImportFromEPSG(4326)  # from EPSG - Lat/long
```

### Reproject a point

```{r, engine = 'python'}
from osgeo import ogr
from osgeo import osr

## lat/long definition
source = osr.SpatialReference()
source.ImportFromEPSG(4326)

# http://spatialreference.org/ref/sr-org/6781/
# http://spatialreference.org/ref/epsg/28992/
target = osr.SpatialReference()
target.ImportFromEPSG(28992)

transform = osr.CoordinateTransformation(source, target)
point = ogr.CreateGeometryFromWkt("POINT (5.6660 -51.9872)")
point.Transform(transform)
print point.ExportToWkt()
```

## Raster data with Python

## R from Python

A very simple example using the Python Rpy2 module:
```{r, engine='python'}
import rpy2.robjects as robjects
pi = robjects.r['pi']
print(pi[0])
```

